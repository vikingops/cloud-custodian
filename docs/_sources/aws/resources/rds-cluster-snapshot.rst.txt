.. File Generated By c7n-sphinxext from source. Do not edit.

.. _aws.rds-cluster-snapshot:

aws.rds-cluster-snapshot
========================

Resource manager for RDS cluster snapshots.
    


Filters
-------


  - :ref:`age <aws.rds-cluster-snapshot.filters.age>`

  - :ref:`config-compliance <aws.common.filters.config-compliance>`
  
  - :ref:`cross-account <aws.rds-cluster-snapshot.filters.cross-account>`

  - :ref:`event <aws.common.filters.event>`
  
  - :ref:`finding <aws.common.filters.finding>`
  
  - :ref:`json-diff <aws.rds-cluster-snapshot.filters.json-diff>`

  - :ref:`marked-for-op <aws.common.filters.marked-for-op>`
  
  - :ref:`ops-item <aws.common.filters.ops-item>`
  
  - :ref:`reduce <aws.common.filters.reduce>`
  
  - :ref:`value <aws.common.filters.value>`
  


.. _aws.rds-cluster-snapshot.filters.age:

age
+++
Filters rds cluster snapshots based on age (in days)

:example:

.. code-block:: yaml

        policies:
          - name: rds-cluster-snapshots-expired
            resource: rds-cluster-snapshot
            filters:
              - type: age
                days: 30
                op: gt

.. container:: toggle

  

  .. raw:: html
     
    <div class="header docutils container" style=""></div>

  .. code-block:: yaml

    properties:
      days:
        type: number
      op:
        enum:
        - eq
        - equal
        - ne
        - not-equal
        - gt
        - greater-than
        - ge
        - gte
        - le
        - lte
        - lt
        - less-than
        - glob
        - regex
        - regex-case
        - in
        - ni
        - not-in
        - contains
        - difference
        - intersect
      type:
        enum:
        - age
    required:
    - type





.. _aws.rds-cluster-snapshot.filters.cross-account:

cross-account
+++++++++++++
Check a resource's embedded iam policy for cross account access.
    

.. container:: toggle

  

  .. raw:: html
     
    <div class="header docutils container" style=""></div>

  .. code-block:: yaml

    properties:
      actions:
        items:
          type: string
        type: array
      everyone_only:
        type: boolean
      type:
        enum:
        - cross-account
      whitelist:
        items:
          type: string
        type: array
      whitelist_conditions:
        items:
          type: string
        type: array
      whitelist_from:
        additionalProperties: 'False'
        properties:
          expr:
            oneOf:
            - type: integer
            - type: string
          format:
            enum:
            - csv
            - json
            - txt
            - csv2dict
          url:
            type: string
        required:
        - url
        type: object
      whitelist_orgids:
        items:
          type: string
        type: array
      whitelist_orgids_from:
        additionalProperties: 'False'
        properties:
          expr:
            oneOf:
            - type: integer
            - type: string
          format:
            enum:
            - csv
            - json
            - txt
            - csv2dict
          url:
            type: string
        required:
        - url
        type: object
      whitelist_vpc:
        items:
          type: string
        type: array
      whitelist_vpc_from:
        additionalProperties: 'False'
        properties:
          expr:
            oneOf:
            - type: integer
            - type: string
          format:
            enum:
            - csv
            - json
            - txt
            - csv2dict
          url:
            type: string
        required:
        - url
        type: object
      whitelist_vpce:
        items:
          type: string
        type: array
      whitelist_vpce_from:
        additionalProperties: 'False'
        properties:
          expr:
            oneOf:
            - type: integer
            - type: string
          format:
            enum:
            - csv
            - json
            - txt
            - csv2dict
          url:
            type: string
        required:
        - url
        type: object
    required:
    - type




Permissions - rds:DescribeDBClusterSnapshotAttributes


.. _aws.rds-cluster-snapshot.filters.json-diff:

json-diff
+++++++++
Compute the diff from the current resource to a previous version.

A resource matches the filter if a diff exists between the current
resource and the selected revision.

Utilizes config as a resource revision database.

Revisions can be selected by date, against the previous version, and
against a locked version (requires use of is-locked filter).

.. container:: toggle

  

  .. raw:: html
     
    <div class="header docutils container" style=""></div>

  .. code-block:: yaml

    properties:
      selector:
        enum:
        - previous
        - date
        - locked
      selector_value:
        type: string
      type:
        enum:
        - json-diff
    required:
    - type




Permissions - config:GetResourceConfigHistory




Actions
-------


  - :ref:`auto-tag-user <aws.common.actions.auto-tag-user>`
  
  - :ref:`copy-related-tag <aws.common.actions.copy-related-tag>`
  
  - :ref:`delete <aws.rds-cluster-snapshot.actions.delete>`

  - :ref:`invoke-lambda <aws.common.actions.invoke-lambda>`
  
  - :ref:`invoke-sfn <aws.common.actions.invoke-sfn>`
  
  - :ref:`mark-for-op <aws.common.actions.mark-for-op>`
  
  - :ref:`notify <aws.common.actions.notify>`
  
  - :ref:`post-finding <aws.common.actions.post-finding>`
  
  - :ref:`post-item <aws.common.actions.post-item>`
  
  - :ref:`put-metric <aws.common.actions.put-metric>`
  
  - :ref:`remove-tag <aws.common.actions.remove-tag>`
  
  - :ref:`set-permissions <aws.rds-cluster-snapshot.actions.set-permissions>`

  - :ref:`tag <aws.common.actions.tag>`
  
  - :ref:`webhook <aws.common.actions.webhook>`
  



.. _aws.rds-cluster-snapshot.actions.delete:

delete
++++++
Action to delete rds cluster snapshots

To prevent unwanted deletion of rds cluster snapshots, it is recommended
to apply a filter to the rule

:example:

.. code-block:: yaml

        policies:
          - name: rds-cluster-snapshots-expired-delete
            resource: rds-cluster-snapshot
            filters:
              - type: age
                days: 30
                op: gt
            actions:
              - delete

.. container:: toggle

  

  .. raw:: html
     
    <div class="header docutils container" style=""></div>

  .. code-block:: yaml

    properties:
      type:
        enum:
        - delete
    required:
    - type




Permissions - rds:DeleteDBClusterSnapshot


.. _aws.rds-cluster-snapshot.actions.set-permissions:

set-permissions
+++++++++++++++
Set permissions for copying or restoring an RDS cluster snapshot

Use the 'add' and 'remove' parameters to control which accounts to
add or remove, respectively.  The default is to remove any
permissions granted to other AWS accounts.

Use `remove: matched` in combination with the `cross-account` filter
for more flexible removal options such as preserving access for
a set of whitelisted accounts:

:example:

.. code-block:: yaml

        policies:
          - name: rds-cluster-snapshot-prune-permissions
            resource: rds-cluster-snapshot
            filters:
              - type: cross-account
                whitelist:
                  - '112233445566'
            actions:
              - type: set-permissions
                remove: matched

.. container:: toggle

  

  .. raw:: html
     
    <div class="header docutils container" style=""></div>

  .. code-block:: yaml

    properties:
      add:
        items:
          oneOf:
          - maxLength: 12
            minLength: 12
            type: string
          - enum:
            - all
        type: array
      remove:
        oneOf:
        - enum:
          - matched
        - items:
            oneOf:
            - maxLength: 12
              minLength: 12
              type: string
            - enum:
              - all
          type: array
      type:
        enum:
        - set-permissions
    required:
    - type




Permissions - rds:ModifyDBClusterSnapshotAttribute

